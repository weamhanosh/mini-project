#! /usr/bin/env node
'use strict';

require('airbnb-js-shims');

var _semver = require('semver');

var _semver2 = _interopRequireDefault(_semver);

var _npmRun = require('npm-run');

var _npmRun2 = _interopRequireDefault(_npmRun);

var _getAdapterForReactVersion = require('./getAdapterForReactVersion');

var _getAdapterForReactVersion2 = _interopRequireDefault(_getAdapterForReactVersion);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

/* eslint no-console: 0 */

var reactEnv = process.env.REACT;
var reactArg = process.argv[2];

if (reactEnv && !_semver2['default'].validRange(reactEnv)) {
  throw new Error('REACT environment variable is not a valid semver range');
}

if (reactArg && !_semver2['default'].validRange(reactArg)) {
  throw new Error('Argument supplied to enzyme-adapter-react-install is not a valid semver range');
}

var reactVersion = reactEnv || reactArg;

if (!_semver2['default'].intersects(reactVersion, '>=0.13')) {
  throw new Error('semver range is not valid. Please provide a valid semver range as an argument or environment variable.');
}

console.log('Cleaning up React and related packages...');
var commands = ['npm uninstall --no-save react-dom react-test-renderer react-addons-test-utils enzyme-adapter-react-14 enzyme-adapter-react-15.4 enzyme-adapter-react-15 enzyme-adapter-react-16', 'rimraf node_modules/react-test-renderer node_modules/react', 'npm prune'];

try {
  commands.forEach(function (cmd) {
    _npmRun2['default'].execSync(cmd, { stdio: 'inherit' });
  });
} catch (e) {
  console.error('An uninstallation failed');
  console.log(e);
  process.exit(1);
}

console.log('Installing React@' + String(reactVersion) + ' and related packages...');
var adapterName = (0, _getAdapterForReactVersion2['default'])(reactVersion);

try {
  _npmRun2['default'].execSync('install-peerdeps -S ' + String(adapterName), { stdio: 'inherit' });
} catch (e) {
  console.error('An installation failed');
  console.log(e);
  process.exit(666);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbnp5bWUtYWRhcHRlci1yZWFjdC1pbnN0YWxsLmpzIl0sIm5hbWVzIjpbInJlYWN0RW52IiwicHJvY2VzcyIsImVudiIsIlJFQUNUIiwicmVhY3RBcmciLCJhcmd2Iiwic2VtdmVyIiwidmFsaWRSYW5nZSIsIkVycm9yIiwicmVhY3RWZXJzaW9uIiwiaW50ZXJzZWN0cyIsImNvbnNvbGUiLCJsb2ciLCJjb21tYW5kcyIsImZvckVhY2giLCJjbWQiLCJucG1SdW4iLCJleGVjU3luYyIsInN0ZGlvIiwiZSIsImVycm9yIiwiZXhpdCIsImFkYXB0ZXJOYW1lIl0sIm1hcHBpbmdzIjoiOztBQUdBOztBQUVBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBTkE7O0FBUUEsSUFBTUEsV0FBV0MsUUFBUUMsR0FBUixDQUFZQyxLQUE3QjtBQUNBLElBQU1DLFdBQVdILFFBQVFJLElBQVIsQ0FBYSxDQUFiLENBQWpCOztBQUVBLElBQUlMLFlBQVksQ0FBQ00sb0JBQU9DLFVBQVAsQ0FBa0JQLFFBQWxCLENBQWpCLEVBQThDO0FBQzVDLFFBQU0sSUFBSVEsS0FBSixDQUFVLHdEQUFWLENBQU47QUFDRDs7QUFFRCxJQUFJSixZQUFZLENBQUNFLG9CQUFPQyxVQUFQLENBQWtCSCxRQUFsQixDQUFqQixFQUE4QztBQUM1QyxRQUFNLElBQUlJLEtBQUosQ0FBVSwrRUFBVixDQUFOO0FBQ0Q7O0FBRUQsSUFBTUMsZUFBZVQsWUFBWUksUUFBakM7O0FBRUEsSUFBSSxDQUFDRSxvQkFBT0ksVUFBUCxDQUFrQkQsWUFBbEIsRUFBZ0MsUUFBaEMsQ0FBTCxFQUFnRDtBQUM5QyxRQUFNLElBQUlELEtBQUosQ0FBVSx3R0FBVixDQUFOO0FBQ0Q7O0FBRURHLFFBQVFDLEdBQVIsQ0FBWSwyQ0FBWjtBQUNBLElBQU1DLFdBQVcsQ0FDZixpTEFEZSxFQUVmLDREQUZlLEVBR2YsV0FIZSxDQUFqQjs7QUFNQSxJQUFJO0FBQ0ZBLFdBQVNDLE9BQVQsQ0FBaUIsVUFBQ0MsR0FBRCxFQUFTO0FBQ3hCQyx3QkFBT0MsUUFBUCxDQUFnQkYsR0FBaEIsRUFBcUIsRUFBRUcsT0FBTyxTQUFULEVBQXJCO0FBQ0QsR0FGRDtBQUdELENBSkQsQ0FJRSxPQUFPQyxDQUFQLEVBQVU7QUFDVlIsVUFBUVMsS0FBUixDQUFjLDBCQUFkO0FBQ0FULFVBQVFDLEdBQVIsQ0FBWU8sQ0FBWjtBQUNBbEIsVUFBUW9CLElBQVIsQ0FBYSxDQUFiO0FBQ0Q7O0FBRURWLFFBQVFDLEdBQVIsOEJBQWdDSCxZQUFoQztBQUNBLElBQU1hLGNBQWMsNENBQTBCYixZQUExQixDQUFwQjs7QUFFQSxJQUFJO0FBQ0ZPLHNCQUFPQyxRQUFQLGlDQUF1Q0ssV0FBdkMsR0FBc0QsRUFBRUosT0FBTyxTQUFULEVBQXREO0FBQ0QsQ0FGRCxDQUVFLE9BQU9DLENBQVAsRUFBVTtBQUNWUixVQUFRUyxLQUFSLENBQWMsd0JBQWQ7QUFDQVQsVUFBUUMsR0FBUixDQUFZTyxDQUFaO0FBQ0FsQixVQUFRb0IsSUFBUixDQUFhLEdBQWI7QUFDRCIsImZpbGUiOiJlbnp5bWUtYWRhcHRlci1yZWFjdC1pbnN0YWxsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG4vKiBlc2xpbnQgbm8tY29uc29sZTogMCAqL1xuXG5pbXBvcnQgJ2FpcmJuYi1qcy1zaGltcyc7XG5cbmltcG9ydCBzZW12ZXIgZnJvbSAnc2VtdmVyJztcbmltcG9ydCBucG1SdW4gZnJvbSAnbnBtLXJ1bic7XG5pbXBvcnQgZ2V0QWRhcHRlckZvclJlYWN0VmVyc2lvbiBmcm9tICcuL2dldEFkYXB0ZXJGb3JSZWFjdFZlcnNpb24nO1xuXG5jb25zdCByZWFjdEVudiA9IHByb2Nlc3MuZW52LlJFQUNUO1xuY29uc3QgcmVhY3RBcmcgPSBwcm9jZXNzLmFyZ3ZbMl07XG5cbmlmIChyZWFjdEVudiAmJiAhc2VtdmVyLnZhbGlkUmFuZ2UocmVhY3RFbnYpKSB7XG4gIHRocm93IG5ldyBFcnJvcignUkVBQ1QgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgbm90IGEgdmFsaWQgc2VtdmVyIHJhbmdlJyk7XG59XG5cbmlmIChyZWFjdEFyZyAmJiAhc2VtdmVyLnZhbGlkUmFuZ2UocmVhY3RBcmcpKSB7XG4gIHRocm93IG5ldyBFcnJvcignQXJndW1lbnQgc3VwcGxpZWQgdG8gZW56eW1lLWFkYXB0ZXItcmVhY3QtaW5zdGFsbCBpcyBub3QgYSB2YWxpZCBzZW12ZXIgcmFuZ2UnKTtcbn1cblxuY29uc3QgcmVhY3RWZXJzaW9uID0gcmVhY3RFbnYgfHwgcmVhY3RBcmc7XG5cbmlmICghc2VtdmVyLmludGVyc2VjdHMocmVhY3RWZXJzaW9uLCAnPj0wLjEzJykpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdzZW12ZXIgcmFuZ2UgaXMgbm90IHZhbGlkLiBQbGVhc2UgcHJvdmlkZSBhIHZhbGlkIHNlbXZlciByYW5nZSBhcyBhbiBhcmd1bWVudCBvciBlbnZpcm9ubWVudCB2YXJpYWJsZS4nKTtcbn1cblxuY29uc29sZS5sb2coJ0NsZWFuaW5nIHVwIFJlYWN0IGFuZCByZWxhdGVkIHBhY2thZ2VzLi4uJyk7XG5jb25zdCBjb21tYW5kcyA9IFtcbiAgJ25wbSB1bmluc3RhbGwgLS1uby1zYXZlIHJlYWN0LWRvbSByZWFjdC10ZXN0LXJlbmRlcmVyIHJlYWN0LWFkZG9ucy10ZXN0LXV0aWxzIGVuenltZS1hZGFwdGVyLXJlYWN0LTE0IGVuenltZS1hZGFwdGVyLXJlYWN0LTE1LjQgZW56eW1lLWFkYXB0ZXItcmVhY3QtMTUgZW56eW1lLWFkYXB0ZXItcmVhY3QtMTYnLFxuICAncmltcmFmIG5vZGVfbW9kdWxlcy9yZWFjdC10ZXN0LXJlbmRlcmVyIG5vZGVfbW9kdWxlcy9yZWFjdCcsXG4gICducG0gcHJ1bmUnLFxuXTtcblxudHJ5IHtcbiAgY29tbWFuZHMuZm9yRWFjaCgoY21kKSA9PiB7XG4gICAgbnBtUnVuLmV4ZWNTeW5jKGNtZCwgeyBzdGRpbzogJ2luaGVyaXQnIH0pO1xuICB9KTtcbn0gY2F0Y2ggKGUpIHtcbiAgY29uc29sZS5lcnJvcignQW4gdW5pbnN0YWxsYXRpb24gZmFpbGVkJyk7XG4gIGNvbnNvbGUubG9nKGUpO1xuICBwcm9jZXNzLmV4aXQoMSk7XG59XG5cbmNvbnNvbGUubG9nKGBJbnN0YWxsaW5nIFJlYWN0QCR7cmVhY3RWZXJzaW9ufSBhbmQgcmVsYXRlZCBwYWNrYWdlcy4uLmApO1xuY29uc3QgYWRhcHRlck5hbWUgPSBnZXRBZGFwdGVyRm9yUmVhY3RWZXJzaW9uKHJlYWN0VmVyc2lvbik7XG5cbnRyeSB7XG4gIG5wbVJ1bi5leGVjU3luYyhgaW5zdGFsbC1wZWVyZGVwcyAtUyAke2FkYXB0ZXJOYW1lfWAsIHsgc3RkaW86ICdpbmhlcml0JyB9KTtcbn0gY2F0Y2ggKGUpIHtcbiAgY29uc29sZS5lcnJvcignQW4gaW5zdGFsbGF0aW9uIGZhaWxlZCcpO1xuICBjb25zb2xlLmxvZyhlKTtcbiAgcHJvY2Vzcy5leGl0KDY2Nik7XG59XG4iXX0=
//# sourceMappingURL=enzyme-adapter-react-install.js.map