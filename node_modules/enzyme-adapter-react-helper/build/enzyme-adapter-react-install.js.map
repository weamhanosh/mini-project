{"version":3,"sources":["../src/enzyme-adapter-react-install.js"],"names":["reactEnv","process","env","REACT","reactArg","argv","semver","validRange","Error","reactVersion","intersects","console","log","commands","forEach","cmd","npmRun","execSync","stdio","e","error","exit","adapterName"],"mappings":";;AAGA;;AAEA;;;;AACA;;;;AACA;;;;;;AANA;;AAQA,IAAMA,WAAWC,QAAQC,GAAR,CAAYC,KAA7B;AACA,IAAMC,WAAWH,QAAQI,IAAR,CAAa,CAAb,CAAjB;;AAEA,IAAIL,YAAY,CAACM,oBAAOC,UAAP,CAAkBP,QAAlB,CAAjB,EAA8C;AAC5C,QAAM,IAAIQ,KAAJ,CAAU,wDAAV,CAAN;AACD;;AAED,IAAIJ,YAAY,CAACE,oBAAOC,UAAP,CAAkBH,QAAlB,CAAjB,EAA8C;AAC5C,QAAM,IAAII,KAAJ,CAAU,+EAAV,CAAN;AACD;;AAED,IAAMC,eAAeT,YAAYI,QAAjC;;AAEA,IAAI,CAACE,oBAAOI,UAAP,CAAkBD,YAAlB,EAAgC,QAAhC,CAAL,EAAgD;AAC9C,QAAM,IAAID,KAAJ,CAAU,wGAAV,CAAN;AACD;;AAEDG,QAAQC,GAAR,CAAY,2CAAZ;AACA,IAAMC,WAAW,CACf,iLADe,EAEf,4DAFe,EAGf,WAHe,CAAjB;;AAMA,IAAI;AACFA,WAASC,OAAT,CAAiB,UAACC,GAAD,EAAS;AACxBC,wBAAOC,QAAP,CAAgBF,GAAhB,EAAqB,EAAEG,OAAO,SAAT,EAArB;AACD,GAFD;AAGD,CAJD,CAIE,OAAOC,CAAP,EAAU;AACVR,UAAQS,KAAR,CAAc,0BAAd;AACAT,UAAQC,GAAR,CAAYO,CAAZ;AACAlB,UAAQoB,IAAR,CAAa,CAAb;AACD;;AAEDV,QAAQC,GAAR,8BAAgCH,YAAhC;AACA,IAAMa,cAAc,4CAA0Bb,YAA1B,CAApB;;AAEA,IAAI;AACFO,sBAAOC,QAAP,iCAAuCK,WAAvC,GAAsD,EAAEJ,OAAO,SAAT,EAAtD;AACD,CAFD,CAEE,OAAOC,CAAP,EAAU;AACVR,UAAQS,KAAR,CAAc,wBAAd;AACAT,UAAQC,GAAR,CAAYO,CAAZ;AACAlB,UAAQoB,IAAR,CAAa,GAAb;AACD","file":"enzyme-adapter-react-install.js","sourcesContent":["\n/* eslint no-console: 0 */\n\nimport 'airbnb-js-shims';\n\nimport semver from 'semver';\nimport npmRun from 'npm-run';\nimport getAdapterForReactVersion from './getAdapterForReactVersion';\n\nconst reactEnv = process.env.REACT;\nconst reactArg = process.argv[2];\n\nif (reactEnv && !semver.validRange(reactEnv)) {\n  throw new Error('REACT environment variable is not a valid semver range');\n}\n\nif (reactArg && !semver.validRange(reactArg)) {\n  throw new Error('Argument supplied to enzyme-adapter-react-install is not a valid semver range');\n}\n\nconst reactVersion = reactEnv || reactArg;\n\nif (!semver.intersects(reactVersion, '>=0.13')) {\n  throw new Error('semver range is not valid. Please provide a valid semver range as an argument or environment variable.');\n}\n\nconsole.log('Cleaning up React and related packages...');\nconst commands = [\n  'npm uninstall --no-save react-dom react-test-renderer react-addons-test-utils enzyme-adapter-react-14 enzyme-adapter-react-15.4 enzyme-adapter-react-15 enzyme-adapter-react-16',\n  'rimraf node_modules/react-test-renderer node_modules/react',\n  'npm prune',\n];\n\ntry {\n  commands.forEach((cmd) => {\n    npmRun.execSync(cmd, { stdio: 'inherit' });\n  });\n} catch (e) {\n  console.error('An uninstallation failed');\n  console.log(e);\n  process.exit(1);\n}\n\nconsole.log(`Installing React@${reactVersion} and related packages...`);\nconst adapterName = getAdapterForReactVersion(reactVersion);\n\ntry {\n  npmRun.execSync(`install-peerdeps -S ${adapterName}`, { stdio: 'inherit' });\n} catch (e) {\n  console.error('An installation failed');\n  console.log(e);\n  process.exit(666);\n}\n"]}